{"version":3,"sources":["webpack:///./src/lib/components/StorageObserver.react.js"],"names":["StorageObserver","props","state","clear","LAST_OPERATE_KEY","interval","setLastOperate","bind","window","addEventListener","setInterval","timestamp","sessionStorage","getItem","length","Date","now","Number","limit","console","log","setProps","clearInterval","removeEventListener","setItem","id","Component","defaultProps","propTypes","PropTypes","string","number","isRequired","bool","func"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAmC;AACI;AAAA,IAElBA,eAAe;EAAA;EAAA;EAChC,yBAAYC,KAAK,EAAE;IAAA;IAAA;IACf,0BAAMA,KAAK;IAEX,MAAKC,KAAK,GAAG;MAACC,KAAK,EAAE;IAAK,CAAC;IAE3B,MAAKC,gBAAgB,GAAG,cAAc;IACtC,MAAKC,QAAQ,GAAG,IAAI;;IAEpB;IACA,MAAKC,cAAc,GAAG,MAAKA,cAAc,CAACC,IAAI,+BAAM;IAAC;EACzD;EAAC;IAAA;IAAA,OAED,6BAAoB;MAAA;MAChB,IAAI,CAACD,cAAc,EAAE;MACrBE,MAAM,CAACC,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAACH,cAAc,CAAC;MAC1DE,MAAM,CAACC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAACH,cAAc,CAAC;MACxDE,MAAM,CAACC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAACH,cAAc,CAAC;MAEzD,IAAI,CAACD,QAAQ,GAAGK,WAAW,CAAC,YAAM;QAC9B,IAAMC,SAAS,GAAGC,cAAc,CAACC,OAAO,CAAC,MAAI,CAACT,gBAAgB,CAAC;QAC/D,IACIQ,cAAc,CAACE,MAAM,GAAG,CAAC,IACzBC,IAAI,CAACC,GAAG,EAAE,GAAGC,MAAM,CAACN,SAAS,CAAC,GAAG,MAAI,CAACV,KAAK,CAACiB,KAAK,EACnD;UACEN,cAAc,CAACT,KAAK,EAAE;UACtBgB,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;UACvB,MAAI,CAACnB,KAAK,CAACoB,QAAQ,CAAC;YAAClB,KAAK,EAAE;UAAI,CAAC,CAAC;QACtC;MACJ,CAAC,EAAE,IAAI,CAACF,KAAK,CAACI,QAAQ,CAAC;IAC3B;EAAC;IAAA;IAAA,OAED,gCAAuB;MACnBiB,aAAa,CAAC,IAAI,CAACjB,QAAQ,CAAC;MAC5BG,MAAM,CAACe,mBAAmB,CAAC,YAAY,EAAE,IAAI,CAACjB,cAAc,CAAC;MAC7DE,MAAM,CAACe,mBAAmB,CAAC,UAAU,EAAE,IAAI,CAACjB,cAAc,CAAC;MAC3DE,MAAM,CAACe,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAACjB,cAAc,CAAC;IAChE;EAAC;IAAA;IAAA,OAED,0BAAiB;MACbM,cAAc,CAACY,OAAO,CAAC,IAAI,CAACpB,gBAAgB,EAAEW,IAAI,CAACC,GAAG,EAAE,CAAC;MACzD,IAAI,CAACf,KAAK,CAACoB,QAAQ,CAAC;QAAClB,KAAK,EAAE;MAAK,CAAC,CAAC;IACvC;EAAC;IAAA;IAAA,OAED,kBAAS;MACL,IAAOsB,EAAE,GAAI,IAAI,CAACxB,KAAK,CAAhBwB,EAAE;MACT,oBAAO;QAAK,EAAE,EAAEA;MAAG,EAAO;IAC9B;EAAC;EAAA;AAAA,EA/CwCC,+CAAS;AAAlB;AAkDpC1B,eAAe,CAAC2B,YAAY,GAAG;EAC3BtB,QAAQ,EAAE,KAAK;EACfF,KAAK,EAAE;AACX,CAAC;AAEDH,eAAe,CAAC4B,SAAS,GAAG;EACxBH,EAAE,EAAEI,iDAAS,CAACC,MAAM;EACpBZ,KAAK,EAAEW,iDAAS,CAACE,MAAM,CAACC,UAAU;EAClC3B,QAAQ,EAAEwB,iDAAS,CAACE,MAAM;EAC1B5B,KAAK,EAAE0B,iDAAS,CAACI,IAAI;EACrBZ,QAAQ,EAAEQ,iDAAS,CAACK;AACxB,CAAC,C","file":"b28a7ec-main-wps-hmr.js","sourcesContent":["import PropTypes from 'prop-types';\r\nimport React, {Component} from 'react';\r\n\r\nexport default class StorageObserver extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {clear: false};\r\n\r\n        this.LAST_OPERATE_KEY = 'last_operate';\r\n        this.interval = null;\r\n\r\n        // bind\r\n        this.setLastOperate = this.setLastOperate.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setLastOperate();\r\n        window.addEventListener('touchstart', this.setLastOperate);\r\n        window.addEventListener('touchend', this.setLastOperate);\r\n        window.addEventListener('touchmove', this.setLastOperate);\r\n\r\n        this.interval = setInterval(() => {\r\n            const timestamp = sessionStorage.getItem(this.LAST_OPERATE_KEY);\r\n            if (\r\n                sessionStorage.length > 1 &&\r\n                Date.now() - Number(timestamp) > this.props.limit\r\n            ) {\r\n                sessionStorage.clear();\r\n                console.log('-- CLEAR');\r\n                this.props.setProps({clear: true});\r\n            }\r\n        }, this.props.interval);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        clearInterval(this.interval);\r\n        window.removeEventListener('touchstart', this.setLastOperate);\r\n        window.removeEventListener('touchend', this.setLastOperate);\r\n        window.removeEventListener('touchmove', this.setLastOperate);\r\n    }\r\n\r\n    setLastOperate() {\r\n        sessionStorage.setItem(this.LAST_OPERATE_KEY, Date.now());\r\n        this.props.setProps({clear: false});\r\n    }\r\n\r\n    render() {\r\n        const {id} = this.props;\r\n        return <div id={id}></div>;\r\n    }\r\n}\r\n\r\nStorageObserver.defaultProps = {\r\n    interval: 10000,\r\n    clear: false,\r\n};\r\n\r\nStorageObserver.propTypes = {\r\n    id: PropTypes.string,\r\n    limit: PropTypes.number.isRequired,\r\n    interval: PropTypes.number,\r\n    clear: PropTypes.bool,\r\n    setProps: PropTypes.func,\r\n};\r\n"],"sourceRoot":""}