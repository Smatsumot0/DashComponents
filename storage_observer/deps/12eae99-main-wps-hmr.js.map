{"version":3,"sources":["webpack:///./src/lib/components/StorageObserver.react.js"],"names":["StorageObserver","props","state","clear","LAST_OPERATE_KEY","interval","setLastOperate","bind","window","addEventListener","setInterval","timestamp","sessionStorage","getItem","Date","now","Number","limit","console","log","setState","clearInterval","removeEventListener","setItem","id","Component","defaultProps","propTypes","PropTypes","string","number","isRequired","setProps","func"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAmC;AACI;AAAA,IAElBA,eAAe;EAAA;EAAA;EAChC,yBAAYC,KAAK,EAAE;IAAA;IAAA;IACf,0BAAMA,KAAK;IAEX,MAAKC,KAAK,GAAG;MAACC,KAAK,EAAE;IAAK,CAAC;IAE3B,MAAKC,gBAAgB,GAAG,cAAc;IACtC,MAAKC,QAAQ,GAAG,IAAI;;IAEpB;IACA,MAAKC,cAAc,GAAG,MAAKA,cAAc,CAACC,IAAI,+BAAM;IAAC;EACzD;EAAC;IAAA;IAAA,OAED,6BAAoB;MAAA;MAChB,IAAI,CAACD,cAAc,EAAE;MACrBE,MAAM,CAACC,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAACH,cAAc,CAAC;MAC1DE,MAAM,CAACC,gBAAgB,CAAC,UAAU,EAAE,IAAI,CAACH,cAAc,CAAC;MACxDE,MAAM,CAACC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAACH,cAAc,CAAC;MAEzD,IAAI,CAACD,QAAQ,GAAGK,WAAW,CAAC,YAAM;QAC9B,IAAMC,SAAS,GAAGC,cAAc,CAACC,OAAO,CAAC,MAAI,CAACT,gBAAgB,CAAC;QAC/D,IACIO,SAAS,IACTG,IAAI,CAACC,GAAG,EAAE,GAAGC,MAAM,CAACL,SAAS,CAAC,GAAG,MAAI,CAACV,KAAK,CAACgB,KAAK,EACnD;UACEL,cAAc,CAACT,KAAK,EAAE;UACtBe,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;UACvB,MAAI,CAACC,QAAQ,CAAC;YAACjB,KAAK,EAAE;UAAI,CAAC,CAAC;QAChC;MACJ,CAAC,EAAE,IAAI,CAACF,KAAK,CAACI,QAAQ,CAAC;IAC3B;EAAC;IAAA;IAAA,OAED,gCAAuB;MACnBgB,aAAa,CAAC,IAAI,CAAChB,QAAQ,CAAC;MAC5BG,MAAM,CAACc,mBAAmB,CAAC,YAAY,EAAE,IAAI,CAAChB,cAAc,CAAC;MAC7DE,MAAM,CAACc,mBAAmB,CAAC,UAAU,EAAE,IAAI,CAAChB,cAAc,CAAC;MAC3DE,MAAM,CAACc,mBAAmB,CAAC,WAAW,EAAE,IAAI,CAAChB,cAAc,CAAC;IAChE;EAAC;IAAA;IAAA,OAED,0BAAiB;MACbM,cAAc,CAACW,OAAO,CAAC,IAAI,CAACnB,gBAAgB,EAAEU,IAAI,CAACC,GAAG,EAAE,CAAC;MACzD,IAAI,CAACK,QAAQ,CAAC;QAACjB,KAAK,EAAE;MAAK,CAAC,CAAC;IACjC;EAAC;IAAA;IAAA,OAED,kBAAS;MACL,IAAOqB,EAAE,GAAI,IAAI,CAACvB,KAAK,CAAhBuB,EAAE;MACT,oBAAO;QAAK,EAAE,EAAEA;MAAG,EAAO;IAC9B;EAAC;EAAA;AAAA,EA/CwCC,+CAAS;AAAlB;AAkDpCzB,eAAe,CAAC0B,YAAY,GAAG;EAC3BrB,QAAQ,EAAE;AACd,CAAC;AAEDL,eAAe,CAAC2B,SAAS,GAAG;EACxBH,EAAE,EAAEI,iDAAS,CAACC,MAAM;EACpBZ,KAAK,EAAEW,iDAAS,CAACE,MAAM,CAACC,UAAU;EAClC1B,QAAQ,EAAEuB,iDAAS,CAACE,MAAM;EAC1BE,QAAQ,EAAEJ,iDAAS,CAACK;AACxB,CAAC,C","file":"12eae99-main-wps-hmr.js","sourcesContent":["import PropTypes from 'prop-types';\r\nimport React, {Component} from 'react';\r\n\r\nexport default class StorageObserver extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {clear: false};\r\n\r\n        this.LAST_OPERATE_KEY = 'last_operate';\r\n        this.interval = null;\r\n\r\n        // bind\r\n        this.setLastOperate = this.setLastOperate.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setLastOperate();\r\n        window.addEventListener('touchstart', this.setLastOperate);\r\n        window.addEventListener('touchend', this.setLastOperate);\r\n        window.addEventListener('touchmove', this.setLastOperate);\r\n\r\n        this.interval = setInterval(() => {\r\n            const timestamp = sessionStorage.getItem(this.LAST_OPERATE_KEY);\r\n            if (\r\n                timestamp &&\r\n                Date.now() - Number(timestamp) > this.props.limit\r\n            ) {\r\n                sessionStorage.clear();\r\n                console.log('-- CLEAR');\r\n                this.setState({clear: true});\r\n            }\r\n        }, this.props.interval);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        clearInterval(this.interval);\r\n        window.removeEventListener('touchstart', this.setLastOperate);\r\n        window.removeEventListener('touchend', this.setLastOperate);\r\n        window.removeEventListener('touchmove', this.setLastOperate);\r\n    }\r\n\r\n    setLastOperate() {\r\n        sessionStorage.setItem(this.LAST_OPERATE_KEY, Date.now());\r\n        this.setState({clear: false});\r\n    }\r\n\r\n    render() {\r\n        const {id} = this.props;\r\n        return <div id={id}></div>;\r\n    }\r\n}\r\n\r\nStorageObserver.defaultProps = {\r\n    interval: 10000,\r\n};\r\n\r\nStorageObserver.propTypes = {\r\n    id: PropTypes.string,\r\n    limit: PropTypes.number.isRequired,\r\n    interval: PropTypes.number,\r\n    setProps: PropTypes.func,\r\n};\r\n"],"sourceRoot":""}