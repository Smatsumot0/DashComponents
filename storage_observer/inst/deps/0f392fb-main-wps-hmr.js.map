{"version":3,"sources":["webpack:///./src/lib/components/StorageObserver.react.js"],"names":["Background","styled","div","Alert","Button","button","StorageObserver","props","state","clear","LAST_OPERATE_KEY","interval","setLastOperate","bind","window","addEventListener","setInterval","timestamp","sessionStorage","getItem","Date","now","Number","limit","setState","clearInterval","removeEventListener","setItem","id","show_alert","message","button_title","setProps","children","Component","defaultProps","reload","propTypes","PropTypes","string","number","isRequired","bool","func"],"mappings":"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","file":"0f392fb-main-wps-hmr.js","sourcesContent":["import PropTypes from 'prop-types';\r\nimport React, {Component} from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst Background = styled.div`\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 100%;\r\n    height: 100%;\r\n    background-color: #00000099;\r\n`;\r\nconst Alert = styled.div`\r\n    padding: 10px 20px;\r\n    background-color: white;\r\n    border-radius: 10px;\r\n    display: flex;\r\n    flex-direction: column;\r\n`;\r\nconst Button = styled.button``;\r\n\r\nexport default class StorageObserver extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {clear: false};\r\n\r\n        this.LAST_OPERATE_KEY = 'last_operate';\r\n        this.interval = null;\r\n\r\n        // bind\r\n        this.setLastOperate = this.setLastOperate.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setLastOperate();\r\n        window.addEventListener('touchstart', this.setLastOperate);\r\n        window.addEventListener('touchend', this.setLastOperate);\r\n        window.addEventListener('touchmove', this.setLastOperate);\r\n\r\n        this.interval = setInterval(() => {\r\n            const timestamp = sessionStorage.getItem(this.LAST_OPERATE_KEY);\r\n            if (\r\n                timestamp &&\r\n                Date.now() - Number(timestamp) > this.props.limit\r\n            ) {\r\n                sessionStorage.clear();\r\n                this.setState({clear: true});\r\n                // alert(MSG.SESSION_TIMEOUT);\r\n                // location.reload();\r\n            }\r\n        }, this.props.interval);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        clearInterval(this.interval);\r\n        window.removeEventListener('touchstart', this.setLastOperate);\r\n        window.removeEventListener('touchend', this.setLastOperate);\r\n        window.removeEventListener('touchmove', this.setLastOperate);\r\n    }\r\n\r\n    setLastOperate() {\r\n        sessionStorage.setItem(this.LAST_OPERATE_KEY, Date.now());\r\n        this.setState({clear: false});\r\n    }\r\n\r\n    render() {\r\n        const {id, show_alert, message, button_title, setProps} = this.props;\r\n\r\n        let children;\r\n        if (show_alert) {\r\n            children = (\r\n                <Background id={id}>\r\n                    <Alert>\r\n                        <div className=\"msg\">{message}</div>\r\n                        <Button type=\"button\">\r\n                            <span>{button_title}</span>\r\n                        </Button>\r\n                    </Alert>\r\n                </Background>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div id={id} className=\"storage_observer\">\r\n                {children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nStorageObserver.defaultProps = {\r\n    interval: 10000,\r\n    show_alert: true,\r\n    message: 'Reload.',\r\n    button_title: 'OK',\r\n    reload: true,\r\n};\r\n\r\nStorageObserver.propTypes = {\r\n    id: PropTypes.string,\r\n    limit: PropTypes.number.isRequired,\r\n    interval: PropTypes.number,\r\n    show_alert: PropTypes.bool,\r\n    message: PropTypes.string,\r\n    button_title: PropTypes.string,\r\n    reload: PropTypes.bool,\r\n    setProps: PropTypes.func,\r\n};\r\n"],"sourceRoot":""}