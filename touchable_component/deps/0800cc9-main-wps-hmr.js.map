{"version":3,"sources":["webpack:///./src/lib/components/TouchableComponent.react.js"],"names":["TouchableComponent","props","startPos","endPos","minDistance","maxTime","count","maxCount","interval","timerId","state","active","isLongTap","isActive","setState","e","touches","rect","target","getBoundingClientRect","t","push","x","clientX","left","y","clientY","Up","targetTouches","timeStamp","Date","now","info","getSwipeInfo","isTimeOver","console","log","time","isShort","direction","setProps","flick","swipe","setInterval","long_tap","long_tap_end","long_swipe","clearInterval","distance","Math","abs","children","id","className","updateActive","longTap","swipeStart","start_timestamp","longTapEnd","swipeEnd","end_timestamp","swipeMove","touchData","Component","defaultProps","propTypes","PropTypes","node","string","n_clicks","number","func"],"mappings":"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","file":"0800cc9-main-wps-hmr.js","sourcesContent":["import PropTypes from 'prop-types';\r\nimport React, {Component} from 'react';\r\n/**\r\n * ExampleComponent is an example component.\r\n * It takes a property, `label`, and\r\n * displays it.\r\n * It renders an input with the property `value`\r\n * which is editable by the user.\r\n */\r\nexport default class TouchableComponent extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        // swipe\r\n        this.startPos = {};\r\n        this.endPos = {};\r\n        this.minDistance = 100;\r\n        this.maxTime = 150;\r\n\r\n        // long tap\r\n        this.count = 0;\r\n        this.maxCount = 5;\r\n        this.interval = 100;\r\n        this.timerId = null;\r\n\r\n        this.state = {active: false, isLongTap: false};\r\n    }\r\n    updateActive(isActive) {\r\n        this.setState({active: isActive});\r\n    }\r\n    touchData(e) {\r\n        let touches = [];\r\n        const rect = e.target.getBoundingClientRect();\r\n        for (let t of e.touches) {\r\n            touches.push({x: t.clientX - rect.left, y: t.clientY - rect.Up});\r\n        }\r\n        return touches;\r\n    }\r\n\r\n    /* ----------------------------------------------------------------------\r\n     * スワイプ\r\n     * ---------------------------------------------------------------------*/\r\n    swipeStart(e) {\r\n        this.startPos = {\r\n            x: e.targetTouches[0].clientX,\r\n            y: e.targetTouches[0].clientY,\r\n            timeStamp: Date.now(),\r\n        };\r\n        this.endPos = {};\r\n    }\r\n    swipeMove(e) {\r\n        this.endPos = {\r\n            x: e.targetTouches[0].clientX,\r\n            y: e.targetTouches[0].clientY,\r\n        };\r\n    }\r\n    swipeEnd(e) {\r\n        this.endPos.timeStamp = Date.now();\r\n        const info = this.getSwipeInfo();\r\n        if (!info) return;\r\n\r\n        // 最大時間以上の場合 何もしない\r\n        if (info.isTimeOver) {\r\n            console.log(\r\n                '--- TOUCHABLE COMPONENT MAX TIME',\r\n                info.time + ' > ' + this.maxTime\r\n            );\r\n            return;\r\n        }\r\n\r\n        if (info.isShort) {\r\n            // 最短距離以下 フリック\r\n            console.log('--- TOUCHABLE COMPONENT FLICK', info.direction);\r\n            this.props.setProps({direction: info.direction, flick: Date.now()});\r\n        } else {\r\n            // 最短距離以上 スワイプ\r\n            console.log('--- TOUCHABLE COMPONENT SWIPE', info.direction);\r\n            this.props.setProps({direction: info.direction, swipe: Date.now()});\r\n        }\r\n    }\r\n\r\n    /* ----------------------------------------------------------------------\r\n     * 長押し\r\n     * ---------------------------------------------------------------------*/\r\n    longTap() {\r\n        this.timerId = setInterval(() => {\r\n            this.count++;\r\n            if (this.count === this.maxCount && !this.getSwipeInfo()) {\r\n                this.setState({isLongTap: true});\r\n                this.props.setProps({long_tap: Date.now()});\r\n                console.log('--- TOUCHABLE COMPONENT LONG TAP');\r\n            }\r\n        }, this.interval);\r\n    }\r\n    longTapEnd() {\r\n        if (this.state.isLongTap) {\r\n            this.props.setProps({long_tap_end: Date.now()});\r\n            const info = this.getSwipeInfo();\r\n            if (info && !info.isShort) {\r\n                console.log(\r\n                    '--- TOUCHABLE COMPONENT LONG SWIPE',\r\n                    info.direction\r\n                );\r\n                this.props.setProps({\r\n                    direction: info.direction,\r\n                    long_swipe: Date.now(),\r\n                });\r\n            }\r\n        }\r\n\r\n        this.count = 0;\r\n        this.setState({isLongTap: false});\r\n        clearInterval(this.timerId);\r\n    }\r\n\r\n    /**\r\n     * スワイプ情報取得\r\n     * @returns\r\n     */\r\n    getSwipeInfo() {\r\n        if (!this.endPos.x || !this.startPos.x) return null;\r\n\r\n        const x = this.endPos.x - this.startPos.x;\r\n        const y = this.endPos.y - this.startPos.y;\r\n\r\n        let isTimeOver = false;\r\n        let time = null;\r\n        if (this.endPos.timeStamp) {\r\n            time = this.endPos.timeStamp - this.startPos.timeStamp;\r\n            isTimeOver = time > this.maxTime;\r\n        }\r\n\r\n        // スワイプの方向\r\n        let direction;\r\n        let distance;\r\n        if (Math.abs(x) > Math.abs(y)) {\r\n            direction = x < 0 ? 'left' : 'right';\r\n            distance = Math.abs(x);\r\n        } else {\r\n            direction = y < 0 ? 'up' : 'down';\r\n            distance = Math.abs(y);\r\n        }\r\n\r\n        return {\r\n            time,\r\n            direction,\r\n            distance,\r\n            isTimeOver,\r\n            isShort: distance < this.minDistance,\r\n        };\r\n    }\r\n\r\n    render() {\r\n        const {children, id, className, setProps} = this.props;\r\n        return (\r\n            <div\r\n                id={id}\r\n                className={\r\n                    className +\r\n                    (this.state.active ? ' active' : '') +\r\n                    (this.state.isLongTap ? ' long_tap' : '')\r\n                }\r\n                onTouchStart={(e) => {\r\n                    this.updateActive(true);\r\n                    this.longTap();\r\n                    this.swipeStart(e);\r\n                    setProps({start_timestamp: Date.now()});\r\n                }}\r\n                onTouchEnd={(e) => {\r\n                    this.updateActive(false);\r\n                    this.longTapEnd();\r\n                    this.swipeEnd(e);\r\n                    setProps({end_timestamp: Date.now()});\r\n                }}\r\n                onTouchMove={(e) => {\r\n                    this.swipeMove(e);\r\n                    setProps({touches: this.touchData(e)});\r\n                }}\r\n                onClick={(e) => setProps({end_timestamp: Date.now()})}\r\n            >\r\n                {children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nTouchableComponent.defaultProps = {};\r\n\r\nTouchableComponent.propTypes = {\r\n    children: PropTypes.node,\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    n_clicks: PropTypes.number,\r\n    setProps: PropTypes.func,\r\n};\r\n"],"sourceRoot":""}